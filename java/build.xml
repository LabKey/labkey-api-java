<project name="remoteapi" basedir="." default="build">

    <property name="source.dir" value="${basedir}/src"/>
    <property name="build.dir" value="${basedir}/build"/>
    <property name="build.classes.dir" value="${build.dir}/classes"/>
    <property name="build.jar.dir" value="${build.dir}/jar"/>
    <property name="build.jar.name" value="labkey-remote-api-1.0.jar"/>
    <property name="dist.dir" value="${basedir}/dist"/>
    <property name="doc.dir" value="${dist.dir}/doc"/>
    <property name="zip.name" value="labkey-remote-api-java-1.0.zip"/>

    <path id="component.class.path">
        <fileset dir="lib" includes="*.jar"/>
    </path>


    <target name="clean">
        <delete dir="${build.dir}"/>
        <delete dir="${dist.dir}"/>
    </target>

    <target name="compile">
        <mkdir dir="${build.classes.dir}"/>
        <javac srcdir="${source.dir}" destdir="${build.classes.dir}"
               classpathref="component.class.path"  target="1.5"/>
    </target>

    <target name="jar" depends="compile">
        <mkdir dir="${build.jar.dir}"/>
        <jar destfile="${build.jar.dir}/${build.jar.name}" basedir="${build.classes.dir}"/>
    </target>

    <target name="javadoc">
        <javadoc sourcepath="${source.dir}" destdir="${doc.dir}" classpathref="component.class.path"
                 windowtitle="LabKey Remote API Library for Java Documentation"
                 author="true" version="true" packagenames="org.labkey.remoteapi.*"/>
    </target>

    <target name="dist" depends="compile,jar,javadoc">
        <delete file="${dist.dir}/${zip.name}"/>
        <mkdir dir="${dist.dir}"/>
        <copy file="${build.jar.dir}/${build.jar.name}" tofile="${dist.dir}/${build.jar.name}"/>
        <copy todir="${dist.dir}/lib/">
            <fileset dir="lib" includes="*.jar"/>
        </copy>
        <zip basedir="${dist.dir}" destfile="${dist.dir}/${zip.name}"/>
    </target>

    <target name="build" depends="dist"/>
    <target name="rebuild" depends="clean,build"/>
</project>